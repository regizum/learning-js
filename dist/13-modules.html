<!DOCTYPE html>
<html lang="ru">
  <head>
    <title>13. Модули</title>
    <meta charset="UTF-8" />
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>
    <script src="../js/main.js"></script>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>

    <style>
      xmp {
        font-family: inherit;
      }
      pre {
        background: #f5f2f0;
        padding: 16px;
        border-radius: 8px;
        white-space: break-spaces;
      }

      .card-body div:last-child,
      .card-body ul:last-child,
      .card-body ol:last-child,
      .card-body pre:last-child ,
      .card-body p:last-child {
          margin-bottom: 0;
      }
    </style>
  </head>
  <body class="pt-5">
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
      <div class="container">
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdownMenuLink1"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                JavaScript</a
              >
              <div
                class="dropdown-menu"
                aria-labelledby="navbarDropdownMenuLink1"
              >
                <a class="dropdown-item" href="/dist/1-intro.html"
                  >1. Введение</a
                >
                <a class="dropdown-item" href="/dist/2-first-steps.html"
                  >2. Основы JavaScript</a
                >
                <a class="dropdown-item" href="/dist/3-code-quality.html"
                  >3. Качество кода</a
                >
                <a class="dropdown-item" href="/dist/4-object-basics.html"
                  >4. Объекты: основы</a
                >
                <a class="dropdown-item" href="/dist/5-data-types.html"
                  >5. Типы данных</a
                >
                <a class="dropdown-item" href="/dist/6-advanced-functions.html"
                  >6. Продвинутая работа с функциями</a
                >
                <a class="dropdown-item" href="/dist/7-object-properties.html"
                  >7. Свойства объекта, их конфигурация</a
                >
                <a class="dropdown-item" href="/dist/8-prototypes.html"
                  >8. Прототипы, наследование</a
                >
                <a class="dropdown-item" href="/dist/9-classes.html"
                  >9. Классы</a
                >
                <a class="dropdown-item" href="/dist/10-error-handling.html"
                  >10. Обработка ошибок</a
                >
                <a class="dropdown-item" href="/dist/11-async.html"
                  >11. Промисы, async/await</a
                >
                <a class="dropdown-item" href="/dist/12-generators-iterators.html"
                  >12. Генераторы, продвинутая итерация</a
                >
                <a class="dropdown-item" href="/dist/13-modules.html"
                  >13. Модули</a
                >
                <a class="dropdown-item" href="/dist/_3-6-network.html"
                  >3-6. Сетевые запросы</a
                >
              </div>
            </li>

<li class="nav-item dropdown">
  <a
    class="nav-link dropdown-toggle"
    href="#"
    id="navbarDropdownMenuLink"
    role="button"
    data-toggle="dropdown"
    aria-haspopup="true"
    aria-expanded="false"
    >Модули</a
  >
  <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
    <a class="dropdown-item" href="#modules-intro">13.1 Модули, введение</a>
    <a class="dropdown-item" href="#import-export">13.2 Экспорт и импорт</a>
    <a class="dropdown-item" href="#modules-dynamic-imports"
      >13.3 Динамические импорты</a
    >
  </div>
</li>

</ul>
</div>
</div>
</nav>

<!-- content -->
<div class="container mt-5">
  <h1>Модули</h1>
  <div class="card mb-3" id="#modules-intro">
    <div class="card-header d-flex align-items-center">
      <h2 class="h5 mb-0">13.1 Модули, введение</h2>

      <div class="ml-auto">
        <a href="https://learn.javascript.ru/generators" target="_blank"
          >Link</a
        >
      </div>
    </div>
    <div class="card-body">
      <p>Подводя итог, основные понятия:</p>
      <ol>
        <li>
          Модуль – это файл. Чтобы работал <code>import/export</code>, нужно для
          браузеров указывать атрибут <code>&lt;script type="module"&gt;</code>.
          У модулей есть ряд особенностей:
          <ul>
            <li>Отложенное (deferred) выполнение по умолчанию.</li>
            <li>Атрибут async работает во встроенных скриптах.</li>
            <li>
              Для загрузки внешних модулей с другого источника, он должен
              ставить заголовки CORS.
            </li>
            <li>Дублирующиеся внешние скрипты игнорируются.</li>
          </ul>
        </li>
        <li>
          У модулей есть своя область видимости, обмениваться функциональностью
          можно через <code>import/export</code>.
        </li>
        <li>В модулях всегда включена директива <code>use strict</code>.</li>
        <li>
          Код в модулях выполняется только один раз. Экспортируемая
          функциональность создаётся один раз и передаётся всем импортёрам.
        </li>
      </ol>
      <p>
        Когда мы используем модули, каждый модуль реализует свою
        функциональность и экспортирует её. Затем мы используем
        <code>import</code>, чтобы напрямую импортировать её туда, куда
        необходимо. Браузер загружает и анализирует скрипты автоматически.
      </p>
    </div>
  </div>
  <div class="card mb-3" id="#import-export">
    <div class="card-header d-flex align-items-center">
      <h2 class="h5 mb-0">13.2 Экспорт и импорт</h2>
      <div class="ml-auto">
        <a href="https://learn.javascript.ru/import-export" target="_blank"
          >Link</a
        >
      </div>
    </div>
    <div class="card-body">
      <p>
        Вот все варианты <code>export</code>, которые мы разобрали в этой и
        предыдущей главах.
      </p>
      <p>Вы можете проверить себя, читая их и вспоминая, что они означают:</p>
      <ul>
        <li>
          Перед объявлением класса/функции/…:
          <ul>
            <li><code>export [default] class/function/variable ...</code></li>
          </ul>
        </li>
        <li>
          Отдельный экспорт:
          <ul>
            <li><code>export {x [as y], ...}</code>.</li>
          </ul>
        </li>
        <li>
          Реэкспорт:
          <ul>
            <li><code>export {x [as y], ...} from "module"</code></li>
            <li>
              <code>export * from "module"</code> (не реэкспортирует
              <code>export default</code>).
            </li>
            <li>
              <code>export {default [as y]} from "module"</code> (реэкспортирует
              только <code>export default</code>).
            </li>
          </ul>
        </li>
      </ul>
      <p>Импорт:</p>
      <ul>
        <li>
          Именованные экспорты из модуля:
          <ul>
            <li><code>import {x [as y], ...} from "module"</code></li>
          </ul>
        </li>
        <li>
          Импорт по умолчанию:
          <ul>
            <li><code>import x from "module"</code></li>
            <li><code>import {default as x} from "module"</code></li>
          </ul>
        </li>
        <li>
          Всё сразу:
          <ul>
            <li><code>import * as obj from "module"</code></li>
          </ul>
        </li>
        <li>
          Только подключить модуль (его код запустится), но не присваивать его
          переменной:
          <ul>
            <li><code>import "module"</code></li>
          </ul>
        </li>
      </ul>
      <p>
        Мы можем поставить <code>import/export</code> в начало или в конец
        скрипта, это не имеет значения.
      </p>
      <p>
        На практике импорты, чаще всего, располагаются в начале файла. Но это
        только для большего удобства.
      </p>
      <p>
        <strong
          >Обратите внимание, что инструкции import/export не работают внутри
          <code>{...}</code>.</strong
        >
      </p>
    </div>
  </div>
  <div class="card mb-3" id="#modules-dynamic-imports">
    <div class="card-header d-flex align-items-center">
      <h2 class="h5 mb-0">13.3 Динамические импорты</h2>
      <div class="ml-auto">
        <a
          href="https://learn.javascript.ru/modules-dynamic-imports"
          target="_blank"
          >Link</a
        >
      </div>
    </div>
    <div class="card-body">
      <pre><code>let modulePath = prompt("Какой модуль загружать?");

import(modulePath)
  .then(obj => <объект модуля>)
  .catch(err => <ошибка загрузки, например если нет такого модуля>)</code></pre>
      <pre><code>let {hi, bye} = await import('./say.js');

hi();
bye();</code></pre>
      <pre><code>// 📁 say.js
export default function() {
  alert("Module loaded (export default)!");
}

let obj = await import('./say.js');
let say = obj.default;
// или, одной строкой: let {default: say} = await import('./say.js');

say();</code></pre>
      <p>
        Динамический импорт работает в обычных скриптах, он не требует указания
        <code>script type="module"</code>.
      </p>
    </div>
  </div>
</div>

<!-- content -->
<!-- footer -->
</body>
</html>
